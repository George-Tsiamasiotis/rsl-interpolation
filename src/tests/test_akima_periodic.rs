use crate::AkimaPeriodic;
use crate::Interpolation;
use crate::tests::XYTable;
use crate::tests::test_interp;

/// Custom against GSL, for f(x) = cos(2*Ï€*x), for x=[0,1]
#[test]
fn test_akima_periodic() {
    let xa = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0];

    #[rustfmt::skip]
    let ya = [
        1.000000000000000, 0.309016994374947, -0.809016994374947,
        -0.809016994374948, 0.309016994374947, 1.000000000000000,
    ];

    #[rustfmt::skip]
    let xtest = [
        0.000000000000000, 0.052631578947368, 0.105263157894737, 0.157894736842105, 0.210526315789474,
        0.263157894736842, 0.315789473684211, 0.368421052631579, 0.421052631578947, 0.473684210526316,
        0.526315789473684, 0.578947368421053, 0.631578947368421, 0.684210526315789, 0.736842105263158,
        0.789473684210526, 0.842105263157894, 0.894736842105263, 0.947368421052631, 1.000000000000000,
    ];

    #[rustfmt::skip]
    let ytest = [
        1.000000000000000, 0.928934657017679, 0.748900534188608, 0.509640490689629, 0.258383653944135,
        -0.036897104662222, -0.362274649293334, -0.663076287136839, -0.885212500770372, -0.997264716057761,
        -0.997264716057761, -0.885212500770372, -0.663076287136839, -0.362274649293335, -0.036897104662223,
        0.258383653944133, 0.509640490689627, 0.748900534188607, 0.928934657017678, 1.000000000000000,
    ];

    #[rustfmt::skip]
    let dytest = [
        0.000000000000004, -2.542963979268214, -4.140813634176468, -4.793548964724756, -4.978154558473962,
        -6.069384074661775, -6.121832427414685, -5.135499616732693, -3.193488135690584, -1.064496045230197,
        1.064496045230191, 3.193488135690583, 5.135499616732687, 6.121832427414679, 6.069384074661773,
        4.978154558473970, 4.793548964724757, 4.140813634176478, 2.542963979268236, 0.000000000000032,
    ];

    #[rustfmt::skip]
    let d2ytest = [
        -57.294901687515825, -39.337729524676483, -21.380557361837141, -3.423385198997792, -30.601781860200020,
        -10.864939754936870, 8.871902350326280, 28.608744455589431, 40.450849718747342, 40.450849718747371,
        40.450849718747392, 40.450849718747421, 28.608744455589434, 8.871902350326341, -10.864939754936756,
        -30.601781860199843, -3.423385198997668, -21.380557361836978, -39.337729524676291, -57.294901687515598,
    ];

    #[rustfmt::skip]
    let iytest = [
        0.000000000000000, 0.051348456805005, 0.095870862495778, 0.129141040742931, 0.149342034559610,
        0.155422527665410, 0.144930115015784, 0.117719510315017, 0.076519868071256, 0.026489536859606,
        -0.026489536859606, -0.076519868071256, -0.117719510315017, -0.144930115015784, -0.155422527665410,
        -0.149342034559610, -0.129141040742931, -0.095870862495778, -0.051348456805006, -0.000000000000000,
    ];

    let data_table = XYTable { x: &xa, y: &ya };

    let test_e_table = XYTable {
        x: &xtest,
        y: &ytest,
    };

    let test_d_table = XYTable {
        x: &xtest,
        y: &dytest,
    };

    let test_d2_table = XYTable {
        x: &xtest,
        y: &d2ytest,
    };

    let test_i_table = XYTable {
        x: &xtest,
        y: &iytest,
    };

    let interp = AkimaPeriodic::new(&xa, &ya).unwrap();
    test_interp(
        data_table,
        test_e_table,
        test_d_table,
        test_d2_table,
        test_i_table,
        interp,
    );
}
