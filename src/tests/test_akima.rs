use crate::Akima;
use crate::Interpolation;
use crate::tests::XYTable;
use crate::tests::test_interp;

/// Custom against GSL, for f(x) = 1 + x^2.
#[test]
fn test_akima2() {
    let xa = [0.0, 0.2, 0.4, 0.6, 0.8, 1.0];

    #[rustfmt::skip]
    let ya = [
        1.000000000000000, 1.040000000000000, 1.160000000000000,
        1.360000000000000, 1.640000000000000, 2.000000000000000,
    ];

    #[rustfmt::skip]
    let xtest = [
        0.000000000000000, 0.052631578947368, 0.105263157894737, 0.157894736842105, 0.210526315789474,
        0.263157894736842, 0.315789473684211, 0.368421052631579, 0.421052631578947, 0.473684210526316,
        0.526315789473684, 0.578947368421053, 0.631578947368421, 0.684210526315789, 0.736842105263158,
        0.789473684210526, 0.842105263157894, 0.894736842105263, 0.947368421052631, 1.000000000000000,
    ];

    #[rustfmt::skip]
    let ytest = [
        1.000000000000000, 1.002770083102493, 1.011080332409972, 1.024930747922438, 1.044321329639889,
        1.069252077562327, 1.099722991689751, 1.135734072022161, 1.177285318559557, 1.224376731301939,
        1.277008310249307, 1.335180055401662, 1.398891966759003, 1.468144044321329, 1.542936288088642,
        1.623268698060942, 1.709141274238227, 1.800554016620498, 1.897506925207756, 1.999999999999999,
    ];

    #[rustfmt::skip]
    let dytest = [
        0.000000000000000, 0.105263157894737, 0.210526315789474, 0.315789473684211, 0.421052631578948,
        0.526315789473685, 0.631578947368422, 0.736842105263158, 0.842105263157894, 0.947368421052630,
        1.052631578947367, 1.157894736842104, 1.263157894736842, 1.368421052631580, 1.473684210526317,
        1.578947368421054, 1.684210526315789, 1.789473684210525, 1.894736842105262, 1.999999999999999,
    ];

    let d2ytest = vec![2.0; xtest.len()];

    #[rustfmt::skip]
    let iytest = [
        0.000000000000000, 0.052680176896535, 0.105651941488069, 0.159206881469602, 0.213636584536133,
        0.269232638382660, 0.326286630704184, 0.385090149195704, 0.445934781552218, 0.509112115468727,
        0.574913738640229, 0.643631238761724, 0.715556203528211, 0.790980220634689, 0.870194877776158,
        0.953491762647616, 1.041162462944063, 1.133498566360499, 1.230791660591922, 1.333333333333333,
    ];

    let data_table = XYTable { x: &xa, y: &ya };

    let test_e_table = XYTable {
        x: &xtest,
        y: &ytest,
    };

    let test_d_table = XYTable {
        x: &xtest,
        y: &dytest,
    };

    let test_d2_table = XYTable {
        x: &xtest,
        y: &d2ytest,
    };

    let test_i_table = XYTable {
        x: &xtest,
        y: &iytest,
    };

    let interp = Akima::new(&xa, &ya).unwrap();
    test_interp(
        data_table,
        test_e_table,
        test_d_table,
        test_d2_table,
        test_i_table,
        interp,
    );
}
